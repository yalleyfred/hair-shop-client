<div class="cart-page">
  <div class="cart-header">
    <div>
      <h2>Your Cart</h2>
      <p class="subtitle">Review your items before checkout.</p>
    </div>
    <div class="cart-header-actions">
      <button class="link-button" type="button" (click)="continueShopping()">Continue Shopping</button>
      <button mat-icon-button type="button" class="back-button" mat-dialog-close>
        <mat-icon>arrow_back</mat-icon>
      </button>
    </div>
  </div>

  @if (items$ | async; as items) {
    @let total = total$ | async;
    @if (items && items.length > 0) {
      <div class="cart-grid">
        @for (item of items; track item.productId) {
        <div class="cart-item">
          <img [alt]="item.name" [src]="item.imageUrl"/>
          <div class="item-details">
            <h3>{{ item.name }}</h3>
            <p class="price">{{ item.price | currency:'GHS':'₵':'1.2-2' }}</p>
            <div class="quantity">
              <button mat-button type="button" (click)="decrease(item)">-</button>
              <span>{{ item.quantity }}</span>
              <button mat-button type="button" (click)="increase(item)">+</button>
            </div>
          </div>
          <button class="remove" mat-button type="button" (click)="remove(item)">Remove</button>
        </div>
        }
      </div>

      <div class="cart-summary">
        <div>
          <p class="label">Total</p>
          <h3>{{ total | currency:'GHS':'₵':'1.2-2' }}</h3>
        </div>
        <div class="summary-actions">
          <button mat-button type="button" (click)="clear()">Clear Cart</button>
          <button mat-raised-button class="checkout" type="button" (click)="checkout(total)">
            Checkout
          </button>
        </div>
      </div>
    } @else {
      <div class="empty-state">
        <mat-icon>shopping_cart</mat-icon>
        <p>Your cart is empty.</p>
        <button class="link-button" type="button" (click)="continueShopping()">Browse products</button>
      </div>
    }
  }
</div>
